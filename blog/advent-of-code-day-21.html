<!DOCTYPE html>
<html lang="en-gb">

<head>
<script data-ad-client="ca-pub-1254309748341319" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "TechArticle",
        "headline": "Advent of Code Day 21: Allergen Assessment",
        "datePublished": "2020-12-21",
        "author": {
          "@type": "Person",
          "name": "Joe Pitts",
          "additionalName": "David",
          "affiliation": "University of Lincoln",
          "jobTitle": "Developer",
          "url": "https://JoePitts.co.uk",
          "sameAs": [
            "https://www.facebook.com/Joe.Pittsy",
            "https://www.linkedin.com/in/JoePittsy",
            "https://twitter.com/JoePittsy",
            "https://www.instagram.com/JoePittsy/",
            "https://github.com/JoePittsy"
          ]
        },
        "description": "Day Twenty One of Advent of Code 2020!",
        "image": "https://joepitts.co.uk/resources/images/xmas/21.jpg"
   
      }
    </script>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JoePittsy" />
    <meta name="twitter:description" content="Allergen Assessment | Advent of Code 2020!" name="description" />
    <meta name="twitter:title" content="Joe Pitts | Advent of Code Day 21" />
    <meta name="twitter:creator" content="@JoePittsy" />
    <meta property="og:image" content="https://joepitts.co.uk/resources/images/xmas/21.jpg" />

    <meta property="og:title" content="Advent of Code Day 21" />
    <meta property="og:description" content="Day Twenty One of Advent of Code 2020!" />
    <meta property="og:url" content="https://joepitts.co.uk/blog/advent-of-code-day-21.html" />
    <meta name="author" content="Joe Pitts" />

    <meta name="twitter:image" content="https://joepitts.co.uk/resources/images/xmas/21.jpg" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-114382787-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag("js", new Date());
        gtag("config", "UA-114382787-2");
    </script>
    <script src="/js/darkMode.js" type="text/javascript"></script>
    <script src="/js/clipboard.min.js"></script>
    <link href="/resources/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180" />
    <link href="/resources/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" />
    <link href="/resources/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" />
    <link href="/resources/site.webmanifest" rel="manifest" />
    <link href="/resources/safari-pinned-tab.svg" rel="mask-icon" />
    <meta content="#da532c" name="msapplication-TileColor" />
    <meta content="#ffffff" name="theme-color" />
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>Joe Pitts | Advent of Code Day 21</title>
    <link href="/style.css" rel="stylesheet" type="text/css" />
    <meta content="Advent of Code Day 21!" name="description" />
    <meta lang="en-gb" />
    <noscript>
        <style>
            .jsonly {
                display: none;
            }
        </style>
    </noscript>
</head>

<body link="black" style="height: auto;">
    <div class="content" id="content">
            <header>
      <div id="container">
        <div id="header">
          <img alt="Joe Pitts" id="logo" src="/resources/JoePitts.jpg" title="Joe Pitts" width="10%" />
          <!-- <a href="/" id="title">
                    <p>Joe Pitts</p>
                  </a> -->
          <nav id="normalMenu">
            <ul class="menu">
              <li>
                <a href="/">Home</a>
              </li>
              <li>
                <a href="/blog" id="currentPage">Blog</a>
              </li>
              <li>
                <a href="/work.html">My Work</a>
              </li>
              <li>
                <a href="/games/">Games</a>
              </li>
              <li id="darkItem">
                <img class="toggleDark" onclick="toggleNightMode()" src="../resources/moon.svg">
                <!-- <a class="toggleDark" onclick="toggleNightMode();">Dark Mode</a> -->
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </header>
        <hr />
        <div class="blogPost">
            <h1>Advent of Code: Day 21: Allergen Assessment</h1>
            <span id="readingTime">
                <date>21st of December 2020</date> |
                <p>4 - 5 minutes</p>
            </span>
            <a class="anchor" href="#introduction">
                <h2 id="introduction">Introduction</h2>
            </a>
            <p>
                Todays puzzle was a nice easy one, especially since I solved part two as part of my solution for part
                one!
            </p>

            <a class="anchor" href="#one">
                <h2 id="one">Task One and Two</h2>
            </a>
            <p>
                For task one we are asked to determine which Ingredients do not contain any allergens and to return how
                many times they are present. For task two we must determine which ingredients contain which allergens
                and return an list alphabetically sorted by the allergan name.
            </p>
            <h3>Reading in the data</h3>
            <p>
                The data was read into arrays of arrays where the first sub array contained the ingredients and the
                second the allergens.
            </p>

            <div class="codeSnippet">
                <div class="double-val-label">
                    <span class="python">Python</span>
                    <span data-clipboard-target="#getDataIn" id="dataCopy">Copy</span>
                </div>
            <pre><div id="getDataIn" spellcheck="false" style="color: #383a42; font-family: 'Fira Code', 'Droid Sans Mono', 'monospace', monospace, 'Droid Sans Fallback';font-weight: normal;font-size: 15px;line-height: 19px;white-space: pre;" contenteditable="false"><div><div><span style="color: #a626a4;">def</span><span style="color: #383a42;"> </span><span style="color: #4078f2;">read_data</span><span style="color: #383a42;">(</span><span style="color: #986801;">path</span><span style="color: #383a42;">):</span></div><div><span style="color: #383a42;">    dataset = []</span></div><div><span style="color: #383a42;">    </span><span style="color: #a626a4;">with</span><span style="color: #383a42;"> </span><span style="color: #0184bc;">open</span><span style="color: #383a42;">(path) </span><span style="color: #a626a4;">as</span><span style="color: #383a42;"> f:</span></div><div><span style="color: #383a42;">        </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> line </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> f.readlines():</span></div><div><span style="color: #383a42;">            tmp = []</span></div><div><span style="color: #383a42;">            line = line.split(</span><span style="color: #50a14f;">"("</span><span style="color: #383a42;">)</span></div><div><span style="color: #383a42;">            tmp.append(line[</span><span style="color: #986801;">0</span><span style="color: #383a42;">].strip().split())</span></div><div><span style="color: #383a42;">            tmp.append(line[</span><span style="color: #986801;">1</span><span style="color: #383a42;">].strip()[</span><span style="color: #986801;">9</span><span style="color: #383a42;">:-</span><span style="color: #986801;">1</span><span style="color: #383a42;">].split(</span><span style="color: #50a14f;">", "</span><span style="color: #383a42;">))</span></div><div><span style="color: #383a42;">            dataset.append(tmp)</span></div><div><span style="color: #383a42;">    </span><span style="color: #a626a4;">return</span><span style="color: #383a42;"> dataset</span></div></div></div></pre>
            </div>

            <h3>The Solution</h3>
            <p>
                I used a defaultdict to list the allergan and a list of all ingredients that could be responsible. I
                then use an intersection to find any ingredients that are present in all the foods that contain that
                allergan. We then use the Hopcroft Karp Matching algorithm to match each allergan to a single ingredient.
                For part one we just count all ingredients that are not allergens and for part two we sort the allergan
                list and return it.
            </p>
            <div class="codeSnippet">
                <div class="double-val-label">
                    <span class="python">Python</span>
                    <span data-clipboard-target="#getTaskOne" id="oneCopy">Copy</span>
                </div>
            <pre id="getTaskOne"
                spellcheck="false"><div style="color: #383a42;font-family: 'Fira Code', 'Droid Sans Mono', 'monospace', monospace, 'Droid Sans Fallback';font-weight: normal;font-size: 15px;line-height: 20px;white-space: pre;" spellcheck="false" contenteditable="false"><div><div><span style="color: #a626a4;">def</span><span style="color: #383a42;"> </span><span style="color: #4078f2;">task_one_and_two</span><span style="color: #383a42;">(</span><span style="color: #986801;">dataset</span><span style="color: #383a42;">):</span></div><div><span style="color: #383a42;">    allergens = defaultdict(</span><span style="color: #0184bc;">list</span><span style="color: #383a42;">)</span></div><div><span style="color: #383a42;">    </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> ingredients, allergens_in_ingredients </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> dataset:</span></div><div><span style="color: #383a42;">        </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> allergen </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> allergens_in_ingredients:</span></div><div><span style="color: #383a42;">            allergens[allergen].append(ingredients)</span></div><br><div><span style="color: #383a42;">    </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> name, possibles </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> allergens.items():</span></div><div><span style="color: #383a42;">        suspect_ingredients = </span><span style="color: #0184bc;">set</span><span style="color: #383a42;">(possibles[</span><span style="color: #986801;">0</span><span style="color: #383a42;">]).intersection(*possibles[</span><span style="color: #986801;">1</span><span style="color: #383a42;">:])</span></div><div><span style="color: #383a42;">        allergens[name] = suspect_ingredients</span></div><br><div><span style="color: #383a42;">    network = []</span></div><div><span style="color: #383a42;">    </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> name, ingredients </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> allergens.items():</span></div><div><span style="color: #383a42;">        </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> ingredient </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> ingredients:</span></div><div><span style="color: #383a42;">            network.append((name, ingredient))</span></div><br><div><span style="color: #383a42;">    allergen_names = allergens.keys()</span></div><br><div><span style="color: #383a42;">    network = nx.Graph(network)</span></div><div><span style="color: #383a42;">    matching = hopcroft_karp_matching(network)</span></div><br><div><span style="color: #383a42;">    allergens_part1 = [match[</span><span style="color: #986801;">1</span><span style="color: #383a42;">] </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> match </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> matching.items() </span><span style="color: #a626a4;">if</span><span style="color: #383a42;"> match[</span><span style="color: #986801;">0</span><span style="color: #383a42;">] </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> allergen_names]</span></div><div><span style="color: #383a42;">    allergens_part2 = [match </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> match </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> matching.items() </span><span style="color: #a626a4;">if</span><span style="color: #383a42;"> match[</span><span style="color: #986801;">0</span><span style="color: #383a42;">] </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> allergen_names]</span></div><br><div><span style="color: #383a42;">    all_ingredients = [i </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> ingredient </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> dataset </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> i </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> ingredient[</span><span style="color: #986801;">0</span><span style="color: #383a42;">]]</span></div><div><span style="color: #383a42;">    non_allergens = [i </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> i </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> all_ingredients </span><span style="color: #a626a4;">if</span><span style="color: #383a42;"> i </span><span style="color: #a626a4;">not</span><span style="color: #383a42;"> </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> allergens_part1]</span></div><div><span style="color: #383a42;">    task_2 = </span><span style="color: #50a14f;">","</span><span style="color: #383a42;">.join([ingredient[</span><span style="color: #986801;">1</span><span style="color: #383a42;">] </span><span style="color: #a626a4;">for</span><span style="color: #383a42;"> ingredient </span><span style="color: #a626a4;">in</span><span style="color: #383a42;"> </span><span style="color: #0184bc;">sorted</span><span style="color: #383a42;">(allergens_part2, </span><span style="color: #986801;">key</span><span style="color: #383a42;">=</span><span style="color: #a626a4;">lambda</span><span style="color: #383a42;"> </span><span style="color: #986801;">x</span><span style="color: #383a42;">: x[</span><span style="color: #986801;">0</span><span style="color: #383a42;">])])</span></div><br><div><span style="color: #383a42;">    </span><span style="color: #a626a4;">return</span><span style="color: #383a42;"> </span><span style="color: #0184bc;">len</span><span style="color: #383a42;">(non_allergens), task_2</span></div></div></div></pre>
                </div>

        
            <a class="anchor" href="#links">
                <h2 id="links">Links</h2>
            </a>
            <div class="download">
                <p><a href="https://adventofcode.com/2020/leaderboard/private">Leaderboard Code:</a>
                    <small>353270-1fc6ef28</small>
                </p>
            </div>

            <div class="download">
                <p><a href="https://www.github.com/JoePittsy/AdventOfCode/">Github Repository</a>
                    <small>A link to the github repo containing all the days.</small>
                </p>
            </div>
            <div class="download">
                <p><a href="https://raw.githubusercontent.com/JoePittsy/AdventOfCode/main/Day 21/main.py"
                        download>main.py</a>
                    <small>A direct download of the main.py script</small>
                </p>
                <p class="download__instructions">
                    <small class="download__properties">1.8<abbr title="Kilobytes">Kb</abbr></small>
                </p>
            </div>


        </div>
        <p></p>
        <div id="disqus_thread"></div>
        <script>
            (function () {
                // DON'T EDIT BELOW THIS LINEx
                var d = document,
                    s = d.createElement("script");
                s.src = "https://joepitts-co-uk.disqus.com/embed.js";
                s.setAttribute("data-timestamp", +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the
            <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

<div class="footer">
    <ul class="footerContainer">
      <li>
        <p id="copyright">Copyright © 2018-2021, Joe Pitts. All rights reserved.</p>
      </li>
      <a href="https://www.linkedin.com/in/joepittsy"><img class="footerLogo" src="../resources/ln.svg"></a>
      <a href="https://github.com/JoePittsy">
        <li><img class="footerLogo" src="../resources/github.svg"></li>
      </a>
      <a href="https://twitter.com/JoePittsy">
        <li><img class="footerLogo" src="../resources/twitter.svg"></li>
      </a>
    </ul>

    <div class="mobileFooterContainer">
      <p id="copyright">Copyright © 2018-2021, Joe Pitts. All rights reserved.</p>
      <div class="mobileFooter">
        <a href="https://www.linkedin.com/in/joepittsy"><img class="footerLogo" src="../resources/ln.svg"></a>
        <a href="https://github.com/JoePittsy"><img class="footerLogo" src="../resources/github.svg"></a>
        <a href="https://twitter.com/JoePittsy"><img class="footerLogo" src="../resources/twitter.svg"></a>
      </div>
    </div>
    <script defer>
        (function () {
            new ClipboardJS("#dataCopy, #oneCopy, #twoCopy, #compCopy");
        })();
    </script>
</body>

</html>